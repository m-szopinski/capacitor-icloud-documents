{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst ICloudDocs = registerPlugin('ICloudDocs', {\n    web: () => import('./web.js').then(m => new m.ICloudDocsWeb()),\n});\nexport * from './definitions';\nexport { ICloudDocs };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nimport * as fs from '@browserfs/core/emulation/callbacks';\nimport * as bfs from '@browserfs/core/index';\nimport { StorageFileSystem } from '@browserfs/dom/backends/Storage';\n// import {\n//   initialize,\n// } from '@browserfs/core/emulation/shared'\nexport class ICloudDocsWeb extends WebPlugin {\n    async echo(options) {\n        console.log('ECHO', options);\n        return options;\n    }\n    async readFile(options) {\n        console.log('Read iCloud file', options);\n        return new Promise((resolve, reject) => {\n            fs.readFile(`/fs/${options.filePath}`, 'utf-8', (err, content) => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    fileStream: content,\n                });\n            });\n        });\n    }\n    async readFileB64(options) {\n        console.log('Read Base64 iCloud file', options);\n        return new Promise((resolve, reject) => {\n            fs.readFile(`/fs/${options.filePath}`, (err, content) => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    fileStream: (content === null || content === void 0 ? void 0 : content.toString()) || '',\n                });\n            });\n        });\n    }\n    async removeFile(options) {\n        console.log('Remove iCloud file', options);\n        return new Promise((resolve, reject) => {\n            fs.unlink(`/fs/${options.filePath}`, err => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    result: 'OK',\n                    url: options.filePath,\n                });\n            });\n        });\n    }\n    async writeFile(options) {\n        console.log('Write iCloud file', options);\n        return new Promise((resolve, reject) => {\n            fs.writeFile(`/fs/${options.filePath}`, options.data, err => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    result: 'OK',\n                    url: options.filePath,\n                });\n            });\n        });\n    }\n    async fileExist(options) {\n        console.log('Check if iCloud file exist', options);\n        return new Promise(resolve => {\n            fs.exists(`/fs/${options.path}`, exist => {\n                resolve({\n                    result: exist,\n                });\n            });\n        });\n    }\n    async mkdir(options) {\n        console.log('Create iCloud directory', options);\n        return new Promise((resolve, reject) => {\n            fs.mkdir(`/fs/${options.path}`, undefined, err => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    result: 'OK',\n                    url: options.path,\n                });\n            });\n        });\n    }\n    async stat(options) {\n        console.log('Stat of iCloud file', options);\n        return new Promise((resolve, reject) => {\n            fs.stat(`/fs/${options.path}`, (err, result) => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    type: result.isDirectory() ? 'Directory' : 'File',\n                    size: result.size,\n                    modificationDate: (result === null || result === void 0 ? void 0 : result.mtime.toString()) || new Date().toString(),\n                    creationDate: (result === null || result === void 0 ? void 0 : result.ctime.toString()) || new Date().toString(),\n                });\n            });\n        });\n    }\n    async readdir(options) {\n        console.log('List iCloud files', options);\n        return new Promise((resolve, reject) => {\n            fs.readdir(`/fs/${options.path}`, (err, result) => {\n                if (err) {\n                    reject(err);\n                }\n                resolve({\n                    result: result || [],\n                });\n            });\n        });\n    }\n    async initUbiquitousContainer() {\n        console.log('Init iCloud container');\n        bfs.registerBackend(StorageFileSystem);\n        return new Promise((resolve, reject) => {\n            bfs\n                .configure({\n                '/': { fs: 'Storage', options: { storage: localStorage } },\n            })\n                .then(() => {\n                fs.exists('/fs', exists => {\n                    if (!exists) {\n                        fs.mkdir('/fs', undefined, (err) => {\n                            if (err) {\n                                reject(err);\n                            }\n                            resolve();\n                        });\n                    }\n                    else {\n                        resolve();\n                    }\n                });\n            }).catch((err) => {\n                reject(err);\n            });\n        });\n    }\n    async syncToCloud(options) {\n        console.log('Sync iCloud file', options);\n        return { url: '' };\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","fs","bfs","StorageFileSystem"],"mappings":"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"}